# Item43. 람다보다는 메서드 참조를 사용하라

[메인페이지 이동](../README.md)



람다가 익명클래스보다 나은 점 중에서 가장 큰 특징은 간결함이다. 그런데 자바에는 함수 객체를 심지어 람다보다도 더 간결하게 만드는 방법이 있으니, 바로 메서드 참조이다.


</br>


## 메서드 참조 유형

### 1. 정적 메서드를 가리키는 메서드 참조

> 자바 8 때 Map에 추가된 merge 메서드 예시
```
map.merge(key, 1, (count, incr) -> count + incr);
```

merge 메서드는 키, 값, 함수를 인수로 받으며, 주어진 키가 맵안에 없다면 키 값 쌍을 그대로 저장하고, 키가있다면 함수를 현재 값과 주어진 값에 적용하고, 그 결과로 현재값을 덮어 쓰는 메서드이다.

매개변수인 count와 incr는 크게하는 일 없이 공간을 차지하는데,
자바 8에서 Integer 클래스에는 이 람다와 기능이 같은 정적 메서드 sum을 제공하기 시작했다.

람다대신 메서드의 참조를 전달하면 똑같은 결과를 얻을 수 있다.
```
map.merge(key, 1, Integer::sum);
```




</br>

> 예시
```
Integer::parseInt
```
> 같은 기능을 하는 람다
```
str -> Integer.parseInt(str)
```
</br>

### 2. 인스턴스 메서드 참조

2-1. 한정적 인스턴스 메서드 참조

수신 객체(참조 대상 인스턴스)를 특정하는 한정적 인스턴스 메서드 참조

한정적 참조는 근본적으로 정적 참조와 비슷하다.

즉, 함수 객체가 받는 인수와 참조되는 메서드가 받는 인수가 똑같다.

> 한정적 인스턴스 </br>
메소드 참조 하는 시점에 참조할 외부 인스턴스가 존재</br>
(args) -> expr.instanceMethod(args) </br>
expr::instanceMethod



> 예시
```
Instant.now()::isAfter
```
> 같은 기능을 하는 람다
```
Instant then = Instant.now();
t -> then.isAfter(t)
```
</br>

2-2. 수신 객체를 특정하지 않는 비한정적 인스턴스 메서드 참조

비한정적 참조에서는 함수객체를 적용하는 시점에 수신 객체를 알려준다.

이를 위해 수신 객체 전달용 매개변수가 매개변수 목록의 첫번째로 추가되며, 그 뒤로는 참조되는 메서드 선언에 정의된 매개 변수들이 뒤따른다.

비한정적 참조는 주로 스트림 파이프라인에서의 매핑과 필터 함수에 쓰인다.([item45](../chapter_06/item_45.md))

> 비한정적 인스턴스</br>
메소드 참조 시점에 메서드를 참조할 외부인스턴스가 존재하지 않음</br>
(arg0, rest) -> arg0.instanceMethod(rest) </br>
ClassName::instanceMethod

> 예시
```
String::toLowerCase
```
> 같은 기능을 하는 람다
```
str -> str.toLowerCase()
```
</br>

3. 생성자 참조
팩터리 객체로 사용된다.

3-1. 클래스 생성자를 가리키는 메서드 참조

> 예시
```
TreeMap<K,V>::new
```
> 같은 기능을 하는 람다
```
() -> new TreeMap<K,V>()
```
</br>

3-2. 배열 생성자를 가리키는 메서드 참조


> 예시
```
int[]::new
```
> 같은 기능을 하는 람다
```
len -> new int[len]
```

</br>

## 메서드 참조보다 람다를 사용하는 것이 좋은 케이스

보통은 람다를 메서드 참조로 대체하는 것이 이득이지만 예외가 있다.
</br>

> 람다가 메서드 참조보다 간결한 경우

주로 메서드와 람다가 같은 클래스에 있을때 그렇다.

다음코드가 GoshThisClassNameIsHumongous 클래스에 있다면,
```
service.execute(GoshThisClassNameIsHumongous::action);
```

람다로 대체
```
service.execute(() -> action());
```

메서드 참조 쪽이 더 짧지도, 명확하지도 않다.

java.util.function 패키지가 제공하는 제네릭 정적 팩터리 메서드인 Function.identity()를 사용하기보다는 같은 기능의 람다 (x -> x)를 직접사용하는 편이 코드도 짧고 명확하다.


</br>

### 정리

> 메서드 참조는 람다의 간단명료한 대안이 될 수 있다. <b> 메서드 참조 쪽이 짧고 명확하다면 메서드 참조를 쓰고, 그렇지 않을 때만 람다를 사용하라. </b> </br>